<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Myanmar Marketplace - အွန်လိုင်းဈေးကွက်</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Myanmar's leading marketplace for properties, products, jobs, services and more in Dawei">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="MM Marketplace">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- PWA Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
    <link rel="apple-touch-icon" href="icon-192.png">
    
    <!-- Google Maps API -->
    <script>
        function initGoogleMaps() {
            console.log('Google Maps API loaded');
        }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB1nQ2lcA2kZpmeG6sTQT4WHyrbwd1LPpI&libraries=places&callback=initGoogleMaps"></script>
    
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Pyidaungsu', 'Myanmar Text', sans-serif;
            background: #f5f5f5;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 15px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: white;
            text-decoration: none;
            white-space: nowrap;
        }

        .search-container {
            flex: 1;
            display: flex;
            max-width: 600px;
        }

        .search-input {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 4px 0 0 4px;
            font-size: 14px;
        }

        .search-btn {
            padding: 12px 30px;
            background: #ff6b35;
            border: none;
            border-radius: 0 4px 4px 0;
            color: white;
            cursor: pointer;
            font-weight: 600;
        }

        .cart-icon {
            position: relative;
            color: white;
            font-size: 28px;
            cursor: pointer;
            padding: 5px 15px;
        }

        .cart-count {
            position: absolute;
            top: -5px;
            right: 5px;
            background: #ff6b35;
            color: white;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        /* Main Categories */
        .main-categories {
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
            position: sticky;
            top: 68px;
            z-index: 99;
        }

        .main-cats-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            overflow-x: auto;
            gap: 5px;
        }

        .main-cat-btn {
            padding: 15px 25px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            color: #333;
            white-space: nowrap;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .main-cat-btn.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .main-cat-btn:hover {
            color: #667eea;
        }

        /* Container */
        .container {
            max-width: 1400px;
            margin: 20px auto;
            padding: 0 20px;
        }

        /* Section */
        .section {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            display: none;
        }

        .section.active {
            display: block;
        }

        .section-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #333;
        }

        /* Categories Grid */
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .category-card {
            text-align: center;
            padding: 20px 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
        }

        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.3);
        }

        .category-icon {
            font-size: 42px;
            margin-bottom: 8px;
        }

        .category-name {
            font-weight: 600;
            font-size: 14px;
        }

        /* Products Grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
        }

        .product-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .product-card:hover {
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            transform: translateY(-5px);
        }

        .product-image {
            width: 100%;
            height: 220px;
            object-fit: cover;
            background: #f5f5f5;
        }

        .product-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ff6b35;
            color: white;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }

        .promoted-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: #1e5a78;
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            z-index: 2;
        }

        .favorite-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.9);
            color: #666;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            z-index: 2;
            transition: all 0.3s;
        }

        .favorite-btn:hover {
            background: white;
            color: #ff6b35;
            transform: scale(1.1);
        }

        .verified-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            color: #1e88e5;
            font-size: 12px;
            font-weight: 600;
        }

        .property-type {
            display: inline-block;
            font-size: 13px;
            color: #666;
            margin-right: 8px;
        }

        .property-time {
            display: inline-block;
            font-size: 12px;
            color: #999;
        }

        .property-details {
            display: flex;
            gap: 12px;
            font-size: 13px;
            color: #666;
            margin: 8px 0;
            flex-wrap: wrap;
        }

        .property-detail-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .details-btn {
            display: inline-block;
            padding: 8px 20px;
            background: #1e5a78;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s;
        }

        .details-btn:hover {
            background: #164558;
        }

        .compare-checkbox {
            position: absolute;
            top: 50px;
            left: 10px;
            z-index: 2;
        }

        .compare-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .compare-checkbox label {
            margin-left: 5px;
            font-size: 12px;
            font-weight: 600;
            color: #333;
            background: rgba(255, 255, 255, 0.9);
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
        }

        .compare-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #1e5a78;
            color: white;
            padding: 15px 20px;
            display: none;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.2);
        }

        .compare-bar.active {
            display: flex;
        }

        .compare-bar-content {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .compare-btn {
            background: white;
            color: #1e5a78;
            padding: 10px 25px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .compare-btn:hover {
            background: #f0f0f0;
        }

        .filter-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
        }

        .filter-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
        }

        .filter-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .filter-group select,
        .filter-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .filter-btn {
            background: #667eea;
            color: white;
            padding: 10px 30px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 25px;
        }

        .filter-btn:hover {
            background: #5568d3;
        }

        .quick-links {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 30px;
        }

        .quick-link {
            padding: 12px 15px;
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 13px;
            color: #333;
        }

        .quick-link:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .land-badge {
            display: inline-block;
            background: #8b4513;
            color: white;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            margin-right: 8px;
        }

        .dimensions-text {
            color: #667eea;
            font-weight: 600;
            font-size: 14px;
        }

        /* Flash Sale Banner */
        .flash-sale-banner {
            background: linear-gradient(135deg, #ff6b35 0%, #f5576c 100%);
            border-radius: 12px;
            padding: 25px 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(245, 87, 108, 0.3);
        }

        .flash-sale-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 20px;
        }

        .flash-sale-title {
            font-size: 32px;
            font-weight: bold;
            color: white;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .flash-sale-timer {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .timer-label {
            color: white;
            font-size: 16px;
            font-weight: 600;
        }

        .countdown {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .countdown-box {
            background: white;
            color: #f5576c;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 24px;
            font-weight: bold;
            min-width: 50px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        .countdown-separator {
            color: white;
            font-size: 24px;
            font-weight: bold;
        }

        .shop-all-btn {
            background: white;
            color: #f5576c;
            border: 2px solid white;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
        }

        .shop-all-btn:hover {
            background: transparent;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255,255,255,0.3);
        }

        @media (max-width: 768px) {
            .flash-sale-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .flash-sale-title {
                font-size: 24px;
            }

            .countdown-box {
                padding: 8px 12px;
                font-size: 20px;
                min-width: 40px;
            }

            .timer-label {
                font-size: 14px;
            }
        }

        /* Flash Sale Products Grid */
        .flash-sale-products {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .flash-sale-product-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .flash-sale-product-card:hover {
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            transform: translateY(-5px);
        }

        .flash-sale-discount {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #f5576c;
            color: white;
            padding: 6px 12px;
            border-radius: 6px;
            font-weight: bold;
            font-size: 13px;
            z-index: 2;
        }

        .product-info {
            padding: 15px;
        }

        .product-name {
            font-size: 14px;
            color: #333;
            margin-bottom: 8px;
            height: 40px;
            overflow: hidden;
        }

        .product-price {
            font-size: 20px;
            font-weight: bold;
            color: #ff6b35;
            margin-bottom: 8px;
        }

        .product-location {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
        }

        .add-to-cart-btn, .view-details-btn {
            width: 100%;
            padding: 10px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }

        .add-to-cart-btn:hover, .view-details-btn:hover {
            background: #5568d3;
        }

        /* Map Container */
        #map {
            width: 100%;
            height: 500px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        /* Post Button */
        .floating-post-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: #ff6b35;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: white;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(255, 107, 53, 0.4);
            z-index: 98;
            transition: all 0.3s;
        }

        .floating-post-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 16px rgba(255, 107, 53, 0.5);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            background: white;
            z-index: 10;
        }

        .modal-header h2 {
            font-size: 22px;
            font-weight: bold;
        }

        .close-btn {
            background: transparent;
            border: none;
            font-size: 28px;
            cursor: pointer;
            width: 36px;
            height: 36px;
            border-radius: 50%;
        }

        .close-btn:hover {
            background: #f3f4f6;
        }

        .modal-body {
            padding: 24px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .btn-primary {
            width: 100%;
            background: #667eea;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            font-size: 16px;
        }

        .btn-primary:hover {
            background: #5568d3;
        }

        .helper-text {
            font-size: 12px;
            color: #6b7280;
            margin-top: 4px;
        }

        /* Cart Modal */
        .cart-modal {
            display: none;
            position: fixed;
            top: 0;
            right: 0;
            width: 400px;
            height: 100vh;
            background: white;
            box-shadow: -2px 0 10px rgba(0,0,0,0.2);
            z-index: 1000;
            overflow-y: auto;
        }

        .cart-modal.active {
            display: block;
        }

        .cart-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
        }

        .cart-overlay.active {
            display: block;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-container {
                flex-wrap: wrap;
            }

            .search-container {
                order: 3;
                width: 100%;
                max-width: 100%;
                margin-top: 10px;
            }

            .cart-modal {
                width: 100%;
            }

            .floating-post-btn {
                width: 55px;
                height: 55px;
                bottom: 20px;
                right: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-container">
            <a href="#" class="logo">🛍️ Myanmar Marketplace</a>
            <div class="search-container">
                <input type="text" class="search-input" placeholder="ရှာဖွေရန်..." id="searchInput">
                <button class="search-btn" onclick="searchItems()">🔍</button>
            </div>
            <div class="cart-icon" onclick="toggleCart()">
                🛒
                <span class="cart-count" id="cartCount">0</span>
            </div>
        </div>
    </header>

    <!-- App Download Banner -->
    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 40px 20px; text-align: center; color: white;">
        <h2 style="font-size: 28px; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.2);">📱 Get Our Mobile App</h2>
        <p style="font-size: 16px; margin-bottom: 25px; opacity: 0.95;">
            Install now for faster access, offline mode, and app-like experience!<br>
            <span style="font-size: 18px;">အက်ပ်တပ်ဆင်ပြီး offline ဖြင့် အသုံးပြုနိုင်ပါသည်!</span>
        </p>
        
        <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin-bottom: 20px;">
            <!-- Main Install Button -->
            <button id="mainInstallBtnTop" onclick="triggerInstallFromBanner()" style="
                background: white;
                color: #667eea;
                border: none;
                padding: 15px 40px;
                border-radius: 30px;
                font-size: 18px;
                font-weight: bold;
                cursor: pointer;
                box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                display: flex;
                align-items: center;
                gap: 10px;
                transition: all 0.3s;
            ">
                <span style="font-size: 24px;">📲</span>
                <span>Install App Now</span>
            </button>

            <!-- Android Style Button -->
            <button onclick="triggerInstallFromBanner()" style="
                background: #000;
                color: white;
                border: none;
                padding: 12px 30px;
                border-radius: 8px;
                font-size: 14px;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 10px;
                transition: all 0.3s;
            ">
                <span style="font-size: 20px;">🤖</span>
                <div style="text-align: left;">
                    <div style="font-size: 10px; opacity: 0.8;">GET IT ON</div>
                    <div style="font-size: 16px; font-weight: bold;">Android</div>
                </div>
            </button>

            <!-- iOS Style Button -->
            <button onclick="showIOSInstructions()" style="
                background: #000;
                color: white;
                border: none;
                padding: 12px 30px;
                border-radius: 8px;
                font-size: 14px;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 10px;
                transition: all 0.3s;
            ">
                <span style="font-size: 20px;">🍎</span>
                <div style="text-align: left;">
                    <div style="font-size: 10px; opacity: 0.8;">Download on</div>
                    <div style="font-size: 16px; font-weight: bold;">iPhone</div>
                </div>
            </button>
        </div>

        <!-- Benefits -->
        <div style="display: flex; gap: 25px; justify-content: center; flex-wrap: wrap; font-size: 14px; opacity: 0.95;">
            <span>✓ Works Offline</span>
            <span>✓ Fast Loading</span>
            <span>✓ Push Notifications</span>
            <span>✓ Home Screen Icon</span>
        </div>
    </div>

    <!-- Main Categories -->
    <div class="main-categories">
        <div class="main-cats-container">
            <button class="main-cat-btn" onclick="switchMainCategory('products')">🛒 ကုန်ပစ္စည်းများ</button>
            <button class="main-cat-btn active" onclick="switchMainCategory('properties')">🏠 အိမ်ခြံမြေ</button>
            <button class="main-cat-btn" onclick="switchMainCategory('jobs')">👔 အလုပ်အကိုင်</button>
            <button class="main-cat-btn" onclick="switchMainCategory('healthcare')">🏥 ကျန်းမာရေး</button>
            <button class="main-cat-btn" onclick="switchMainCategory('repair')">🔧 ပြုပြင်ရေး</button>
            <button class="main-cat-btn" onclick="switchMainCategory('beauty')">💆 အလှပြင်</button>
            <button class="main-cat-btn" onclick="switchMainCategory('food')">🍽️ စားသောက်ဆိုင်</button>
            <button class="main-cat-btn" onclick="switchMainCategory('education')">📚 ပညာရေး</button>
            <button class="main-cat-btn" onclick="switchMainCategory('air-tickets')">✈️ လေယာဉ်</button>
            <button class="main-cat-btn" onclick="switchMainCategory('car-tickets')">🚗 ကား</button>
        </div>
    </div>

    <!-- Container -->
    <div class="container">
        <!-- Products Section -->
        <div class="section" id="productsSection">
            <!-- Flash Sale Banner -->
            <div class="flash-sale-banner">
                <div class="flash-sale-header">
                    <h2 class="flash-sale-title">⚡ On Sale</h2>
                    <div class="flash-sale-timer">
                        <span class="timer-label">On Sale Now - Ending in</span>
                        <div class="countdown">
                            <div class="countdown-box">
                                <span id="hours">24</span>
                            </div>
                            <span class="countdown-separator">:</span>
                            <div class="countdown-box">
                                <span id="minutes">22</span>
                            </div>
                            <span class="countdown-separator">:</span>
                            <div class="countdown-box">
                                <span id="seconds">54</span>
                            </div>
                        </div>
                    </div>
                    <button class="shop-all-btn" onclick="filterProducts('flash-sale')">SHOP ALL ON SALE</button>
                </div>
            </div>

            <!-- On Sale Products Grid -->
            <div class="flash-sale-products" id="flashSaleProducts">
                <!-- Flash sale products will be loaded here -->
            </div>

            <h2 class="section-title">📦 ကုန်ပစ္စည်းအမျိုးအစားများ</h2>
            <div class="categories-grid">
                <div class="category-card" onclick="filterProducts('electronics')">
                    <div class="category-icon">📱</div>
                    <div class="category-name">အီလက်ထရောနစ်</div>
                </div>
                <div class="category-card" onclick="filterProducts('fashion')">
                    <div class="category-icon">👕</div>
                    <div class="category-name">ဖက်ရှင်</div>
                </div>
                <div class="category-card" onclick="filterProducts('home')">
                    <div class="category-icon">🏠</div>
                    <div class="category-name">အိမ်သုံးပစ္စည်း</div>
                </div>
                <div class="category-card" onclick="filterProducts('beauty')">
                    <div class="category-icon">💄</div>
                    <div class="category-name">အလှကုန်</div>
                </div>
                <div class="category-card" onclick="filterProducts('sports')">
                    <div class="category-icon">⚽</div>
                    <div class="category-name">အားကစား</div>
                </div>
                <div class="category-card" onclick="filterProducts('grocery')">
                    <div class="category-icon">🛒</div>
                    <div class="category-name">စားသောက်ကုန်</div>
                </div>
            </div>
            <h2 class="section-title">🔥 အရောင်းရဆုံးကုန်ပစ္စည်းများ</h2>
            <div class="products-grid" id="productsGrid"></div>
        </div>

        <!-- Properties Section -->
        <div class="section active" id="propertiesSection">
            <h2 class="section-title">🏠 အိမ်ခြံမြေများ - ထားဝယ်</h2>
            
            <div id="map"></div>
            
            <!-- Advanced Filters -->
            <div class="filter-section" style="margin-top: 20px;">
                <div class="filter-row">
                    <div class="filter-group">
                        <label>အမျိုးအစား</label>
                        <select id="filterType">
                            <option value="">အားလုံး</option>
                            <option value="sale">ရောင်းမည်</option>
                            <option value="rent">ငှားမည်</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>ပစ္စည်းအမျိုးအစား</label>
                        <select id="filterPropertyType">
                            <option value="">အားလုံး</option>
                            <option value="Condo">Condo</option>
                            <option value="Apartment">Apartment</option>
                            <option value="House">House</option>
                            <option value="Land">Land</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>မြို့နယ်</label>
                        <select id="filterTownship">
                            <option value="">အားလုံး</option>
                            <option value="Yangon">ရန်ကုန်</option>
                            <option value="Mandalay">မန္တလေး</option>
                            <option value="Dawei">ထားဝယ်</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>စျေးနှုန်း (သိန်း)</label>
                        <select id="filterPrice">
                            <option value="">အားလုံး</option>
                            <option value="0-500">500 သိန်းအောက်</option>
                            <option value="500-1000">500 - 1000 သိန်း</option>
                            <option value="1000-5000">1000 - 5000 သိန်း</option>
                            <option value="5000+">5000 သိန်းအထက်</option>
                        </select>
                    </div>
                    <button class="filter-btn" onclick="applyFilters()">ရှာမည်</button>
                </div>
            </div>

            <!-- Quick Links -->
            <h3 style="margin: 20px 0 15px 0; font-size: 18px; color: #333;">Popular Searches</h3>
            <div class="quick-links">
                <div class="quick-link" onclick="quickSearch('ground-floor')">Ground Floor Apartments</div>
                <div class="quick-link" onclick="quickSearch('under-1000')">Under 1,000 lakhs</div>
                <div class="quick-link" onclick="quickSearch('bank-installment')">Bank Installment</div>
                <div class="quick-link" onclick="quickSearch('new-launch')">New Launch Properties</div>
                <div class="quick-link" onclick="quickSearch('land-invest')">Lands to Invest</div>
                <div class="quick-link" onclick="quickSearch('mini-condo')">Mini Condo</div>
            </div>

            <h3 class="section-title" style="margin-top: 30px;">📋 အိမ်ခြံမြေစာရင်း</h3>
            <div class="products-grid" id="propertiesGrid"></div>
        </div>

        <!-- Air Tickets Section -->
        <div class="section" id="airTicketsSection">
            <h2 class="section-title">✈️ လေယာဉ်လက်မှတ်များ</h2>
            <div class="products-grid" id="airTicketsGrid"></div>
        </div>

        <!-- Car Tickets Section -->
        <div class="section" id="carTicketsSection">
            <h2 class="section-title">🚗 ကားလက်မှတ်များ</h2>
            <div class="products-grid" id="carTicketsGrid"></div>
        </div>

        <!-- Education Section -->
        <div class="section" id="educationSection">
            <h2 class="section-title">📚 ပညာရေး (Education Centers)</h2>
            <p style="color: #666; margin-bottom: 20px;">ကျောင်းများ၊ သင်တန်းကျောင်းများနှင့် ကုန်ကျစရိတ်အချက်အလက်များ</p>
            
            <div class="products-grid" id="educationGrid">
                <!-- Sample Education Centers -->
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=400" alt="University" class="product-image">
                    <div class="product-info">
                        <div class="product-name">🎓 Dawei University</div>
                        <div class="product-price">500,000 - 1,000,000 ကျပ် / နှစ်</div>
                        <div class="product-location">📍 Dawei, Myanmar</div>
                        <div style="font-size: 13px; color: #666; margin: 10px 0;">
                            Bachelor's Degree Programs<br>
                            • Engineering<br>
                            • Business Administration<br>
                            • Computer Science
                        </div>
                        <div class="product-location">📞 09-XXX-XXX-XXX</div>
                        <button class="details-btn">View Details</button>
                    </div>
                </div>

                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1503676260728-1c00da094a0b?w=400" alt="Language School" class="product-image">
                    <div class="product-info">
                        <div class="product-name">🗣️ English Language Center</div>
                        <div class="product-price">150,000 ကျပ် / လ</div>
                        <div class="product-location">📍 Downtown Dawei</div>
                        <div style="font-size: 13px; color: #666; margin: 10px 0;">
                            English Courses for all levels<br>
                            • Beginner to Advanced<br>
                            • IELTS Preparation<br>
                            • Business English
                        </div>
                        <div class="product-location">📞 09-XXX-XXX-XXX</div>
                        <button class="details-btn">View Details</button>
                    </div>
                </div>

                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1516534775068-ba3e7458af70?w=400" alt="Computer Training" class="product-image">
                    <div class="product-info">
                        <div class="product-name">💻 IT Training Institute</div>
                        <div class="product-price">200,000 - 500,000 ကျပ် / သင်တန်း</div>
                        <div class="product-location">📍 Dawei Technology Park</div>
                        <div style="font-size: 13px; color: #666; margin: 10px 0;">
                            Professional IT Courses<br>
                            • Web Development<br>
                            • Mobile App Development<br>
                            • Data Science
                        </div>
                        <div class="product-location">📞 09-XXX-XXX-XXX</div>
                        <button class="details-btn">View Details</button>
                    </div>
                </div>

                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1427504494785-3a9ca7044f45?w=400" alt="Private School" class="product-image">
                    <div class="product-info">
                        <div class="product-name">🏫 International School Dawei</div>
                        <div class="product-price">2,000,000 - 5,000,000 ကျပ် / နှစ်</div>
                        <div class="product-location">📍 Dawei</div>
                        <div style="font-size: 13px; color: #666; margin: 10px 0;">
                            K-12 International Curriculum<br>
                            • Cambridge Curriculum<br>
                            • Native English Teachers<br>
                            • Modern Facilities
                        </div>
                        <div class="product-location">📞 09-XXX-XXX-XXX</div>
                        <button class="details-btn">View Details</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Jobs Section -->
        <div class="section" id="jobsSection">
            <h2 class="section-title">👔 အလုပ်အကိုင် (Jobs & Employment)</h2>
            <p style="color: #666; margin-bottom: 20px;">အလုပ်ခေါ်စာများနှင့် အလုပ်အကိုင်အခွင့်အလမ်းများ</p>
            
            <div class="products-grid" id="jobsGrid">
                <div class="product-card">
                    <div class="product-info">
                        <div class="product-name">💼 Sales Manager</div>
                        <div class="product-price">500,000 - 800,000 ကျပ် / လ</div>
                        <div class="product-location">📍 ABC Company, Dawei</div>
                        <div style="font-size: 13px; color: #666; margin: 10px 0;">
                            Requirements:<br>
                            • 2+ years experience<br>
                            • Good communication skills<br>
                            • Bachelor's degree
                        </div>
                        <div class="product-location">📅 Posted: 2 days ago</div>
                        <button class="details-btn">Apply Now</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Healthcare Section -->
        <div class="section" id="healthcareSection">
            <h2 class="section-title">🏥 ကျန်းမာရေး (Healthcare Services)</h2>
            <p style="color: #666; margin-bottom: 20px;">ဆေးရုံများ၊ ဆေးခန်းများနှင့် ကျန်းမာရေးဝန်ဆောင်မှုများ</p>
            
            <div class="products-grid" id="healthcareGrid">
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1519494026892-80bbd2d6fd0d?w=400" alt="Hospital" class="product-image">
                    <div class="product-info">
                        <div class="product-name">🏥 Dawei General Hospital</div>
                        <div class="product-price">ဝန်ဆောင်မှု 24/7</div>
                        <div class="product-location">📍 Downtown Dawei</div>
                        <div style="font-size: 13px; color: #666; margin: 10px 0;">
                            Services:<br>
                            • Emergency Care<br>
                            • Outpatient Services<br>
                            • Surgery<br>
                            • Laboratory
                        </div>
                        <div class="product-location">📞 09-XXX-XXX-XXX</div>
                        <button class="details-btn">View Details</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Repair Services Section -->
        <div class="section" id="repairSection">
            <h2 class="section-title">🔧 ပြုပြင်ထိန်းသိမ်းရေး (Repair & Maintenance)</h2>
            <p style="color: #666; margin-bottom: 20px;">ပြုပြင်ဝန်ဆောင်မှုအမျိုးမျိုး</p>
            
            <div class="products-grid" id="repairGrid">
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1581092160562-40aa08e78837?w=400" alt="Phone Repair" class="product-image">
                    <div class="product-info">
                        <div class="product-name">📱 Phone Repair Center</div>
                        <div class="product-price">10,000 - 100,000 ကျပ်</div>
                        <div class="product-location">📍 Mobile Market, Dawei</div>
                        <div style="font-size: 13px; color: #666; margin: 10px 0;">
                            Services:<br>
                            • Screen Replacement<br>
                            • Battery Change<br>
                            • Software Issues<br>
                            • Water Damage Repair
                        </div>
                        <div class="product-location">📞 09-XXX-XXX-XXX</div>
                        <button class="details-btn">Contact Now</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Beauty Section -->
        <div class="section" id="beautySection">
            <h2 class="section-title">💆 အလှပြင်ဆိုင် (Beauty & Salon Services)</h2>
            <p style="color: #666; margin-bottom: 20px;">အလှပြင်ဆိုင်များနှင့် ဝန်ဆောင်မှုများ</p>
            
            <div class="products-grid" id="beautyGrid">
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1560066984-138dadb4c035?w=400" alt="Salon" class="product-image">
                    <div class="product-info">
                        <div class="product-name">💇 Hair Salon & Spa</div>
                        <div class="product-price">10,000 - 80,000 ကျပ်</div>
                        <div class="product-location">📍 Main Road, Dawei</div>
                        <div style="font-size: 13px; color: #666; margin: 10px 0;">
                            Services:<br>
                            • Hair Cut & Styling<br>
                            • Hair Coloring<br>
                            • Facial Treatment<br>
                            • Massage
                        </div>
                        <div class="product-location">📞 09-XXX-XXX-XXX</div>
                        <button class="details-btn">Book Now</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Food & Restaurants Section -->
        <div class="section" id="foodSection">
            <h2 class="section-title">🍽️ စားသောက်ဆိုင်များ (Restaurants & Food)</h2>
            <p style="color: #666; margin-bottom: 20px;">စားသောက်ဆိုင်များနှင့် အစားအသောက်ဝန်ဆောင်မှုများ</p>
            
            <div class="products-grid" id="foodGrid">
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=400" alt="Restaurant" class="product-image">
                    <div class="product-info">
                        <div class="product-name">🍲 Myanmar Traditional Restaurant</div>
                        <div class="product-price">3,000 - 15,000 ကျပ် / လူ</div>
                        <div class="product-location">📍 Downtown Dawei</div>
                        <div style="font-size: 13px; color: #666; margin: 10px 0;">
                            Menu Highlights:<br>
                            • Traditional Myanmar Food<br>
                            • Seafood Specialties<br>
                            • Vegetarian Options<br>
                            • Open: 7 AM - 10 PM
                        </div>
                        <div class="product-location">📞 09-XXX-XXX-XXX</div>
                        <button class="details-btn">View Menu</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Post Button -->
    <div class="floating-post-btn" onclick="openPostModal()">➕</div>

    <!-- Compare Properties Bar -->
    <div class="compare-bar" id="compareBar">
        <div class="compare-bar-content">
            <span id="compareCount">0 properties selected</span>
            <span style="font-size: 12px; opacity: 0.9;">You can compare up to 3 properties</span>
        </div>
        <div style="display: flex; gap: 10px;">
            <button class="compare-btn" onclick="compareProperties()">Compare Now</button>
            <button class="compare-btn" style="background: transparent; border: 1px solid white; color: white;" onclick="clearCompare()">Clear</button>
        </div>
    </div>

    <!-- Cart Overlay -->
    <div class="cart-overlay" id="cartOverlay" onclick="toggleCart()"></div>

    <!-- Cart Modal -->
    <div class="cart-modal" id="cartModal">
        <div class="modal-header">
            <h2>ဈေးခြင်း</h2>
            <button class="close-btn" onclick="toggleCart()">×</button>
        </div>
        <div class="modal-body" id="cartItems">
            <div style="text-align: center; padding: 40px; color: #999;">
                <div style="font-size: 64px;">🛒</div>
                <p>ဈေးခြင်းမှာ ပစ္စည်းမရှိပါ</p>
            </div>
        </div>
    </div>

    <!-- Post Modal -->
    <div id="postModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="postModalTitle">တင်ရန်</h2>
                <button class="close-btn" onclick="closePostModal()">×</button>
            </div>
            <div class="modal-body">
                <!-- Post Type Selection -->
                <div id="postTypeSelection">
                    <h3 style="margin-bottom: 20px;">တင်လိုသော အမျိုးအစားရွေးပါ</h3>
                    <div style="display: grid; gap: 15px;">
                        <button class="btn-primary" onclick="selectPostType('product')">🛒 ကုန်ပစ္စည်းတင်ရန်</button>
                        <button class="btn-primary" onclick="selectPostType('property')">🏠 အိမ်ခြံမြေတင်ရန်</button>
                        <button class="btn-primary" onclick="selectPostType('education')">📚 ပညာရေးဌာနတင်ရန်</button>
                        <button class="btn-primary" onclick="selectPostType('air-ticket')">✈️ လေယာဉ်လက်မှတ်တင်ရန်</button>
                        <button class="btn-primary" onclick="selectPostType('car-ticket')">🚗 ကားလက်မှတ်တင်ရန်</button>
                    </div>
                </div>

                <!-- Product Form -->
                <form id="productForm" style="display: none;" onsubmit="submitProduct(event)">
                    <div class="form-group">
                        <label>ကုန်ပစ္စည်းအမည် *</label>
                        <input type="text" id="prodName" required>
                    </div>
                    <div class="form-group">
                        <label>စျေးနှုန်း (ကျပ်) *</label>
                        <input type="number" id="prodPrice" required>
                    </div>
                    <div class="form-group">
                        <label>အမျိုးအစား *</label>
                        <select id="prodCategory" required>
                            <option value="electronics">အီလက်ထရောနစ်</option>
                            <option value="fashion">ဖက်ရှင်</option>
                            <option value="home">အိမ်သုံးပစ္စည်း</option>
                            <option value="beauty">အလှကုန်</option>
                            <option value="sports">အားကစား</option>
                            <option value="grocery">စားသောက်ကုန်</option>
                            <option value="flash-sale">⚡ Flash Sale (Paid Promotion)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ပုံ *</label>
                        <input type="file" id="prodImage" accept="image/*" required>
                    </div>
                    <div class="form-group">
                        <label>ဖုန်းနံပါတ် *</label>
                        <input type="tel" id="prodPhone" required>
                    </div>
                    <button type="submit" class="btn-primary">တင်မည်</button>
                </form>

                <!-- Property Form -->
                <form id="propertyForm" style="display: none;" onsubmit="submitProperty(event)">
                    <div class="form-group">
                        <label>ခေါင်းစဉ် *</label>
                        <input type="text" id="propTitle" required>
                    </div>
                    <div class="form-group">
                        <label>အမျိုးအစား *</label>
                        <select id="propType" required onchange="togglePropertyFields()">
                            <option value="Condo">Condo</option>
                            <option value="Apartment">Apartment</option>
                            <option value="House">House</option>
                            <option value="Villa">Villa</option>
                            <option value="Studio">Studio</option>
                            <option value="Land">မြေကွက် (Land)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>စျေးနှုန်း (သိန်း) *</label>
                        <input type="number" id="propPrice" required>
                    </div>
                    <div class="form-group">
                        <label>လိပ်စာ *</label>
                        <input type="text" id="propAddress" required>
                    </div>
                    <div class="form-group" id="dimensionsGroup" style="display: none;">
                        <label>မြေကွက်အရွယ်အစား (ပေ) *</label>
                        <input type="text" id="propDimensions" placeholder="ဥပမာ: ၄၀×၆၀">
                        <small style="color: #666; font-size: 12px;">Example: ၄၀×၆၀ or 40×60</small>
                    </div>
                    <div class="form-row" id="bedsAndBathsGroup">
                        <div class="form-group">
                            <label>အိပ်ခန်း</label>
                            <input type="number" id="propBeds" value="2">
                        </div>
                        <div class="form-group">
                            <label>ရေချိုးခန်း</label>
                            <input type="number" id="propBaths" value="1">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>ဧရိယာ (sqft)</label>
                        <input type="number" id="propSqft" placeholder="e.g. 1200">
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="propPromoted" style="width: auto; margin-right: 8px;">
                            Promoted Listing (အခကြေး)
                        </label>
                    </div>
                    <div class="form-group">
                        <label>ပုံ *</label>
                        <input type="file" id="propImage" accept="image/*" required>
                    </div>
                    <div class="form-group">
                        <label>ဖုန်းနံပါတ် *</label>
                        <input type="tel" id="propPhone" required>
                    </div>
                    <button type="submit" class="btn-primary">တင်မည်</button>
                </form>

                <!-- Air Ticket Form -->
                <form id="airTicketForm" style="display: none;" onsubmit="submitAirTicket(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label>မှ *</label>
                            <input type="text" id="airFrom" required>
                        </div>
                        <div class="form-group">
                            <label>သို့ *</label>
                            <input type="text" id="airTo" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>ထွက်ခွာမည့်ရက် *</label>
                        <input type="date" id="airDate" required>
                    </div>
                    <div class="form-group">
                        <label>စျေးနှုန်း (ကျပ်) *</label>
                        <input type="number" id="airPrice" required>
                    </div>
                    <div class="form-group">
                        <label>ဖုန်းနံပါတ် *</label>
                        <input type="tel" id="airPhone" required>
                    </div>
                    <button type="submit" class="btn-primary">တင်မည်</button>
                </form>

                <!-- Car Ticket Form -->
                <form id="carTicketForm" style="display: none;" onsubmit="submitCarTicket(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label>မှ *</label>
                            <input type="text" id="carFrom" required>
                        </div>
                        <div class="form-group">
                            <label>သို့ *</label>
                            <input type="text" id="carTo" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>ထွက်ခွာမည့်ရက် *</label>
                        <input type="date" id="carDate" required>
                    </div>
                    <div class="form-group">
                        <label>ထွက်ခွာမည့်အချိန် *</label>
                        <input type="time" id="carTime" required>
                    </div>
                    <div class="form-group">
                        <label>လက်ကျန်ခုံနေရာ *</label>
                        <input type="number" id="carSeats" required>
                    </div>
                    <div class="form-group">
                        <label>စျေးနှုန်း (ကျပ်) *</label>
                        <input type="number" id="carPrice" required>
                    </div>
                    <div class="form-group">
                        <label>ဖုန်းနံပါတ် *</label>
                        <input type="tel" id="carPhone" required>
                    </div>
                    <button type="submit" class="btn-primary">တင်မည်</button>
                </form>

                <!-- Education Form -->
                <form id="educationForm" style="display: none;" onsubmit="submitEducation(event)">
                    <div class="form-group">
                        <label>အမည် *</label>
                        <input type="text" id="eduName" required placeholder="ဥပမာ: ABC Language Center">
                    </div>
                    <div class="form-group">
                        <label>အမျိုးအစား *</label>
                        <select id="eduType" required>
                            <option value="">ရွေးချယ်ပါ</option>
                            <option value="university">တက္ကသိုလ်</option>
                            <option value="language">ဘာသာစကားသင်တန်း</option>
                            <option value="computer">ကွန်ပျူတာသင်တန်း</option>
                            <option value="school">ကျောင်း</option>
                            <option value="training">သင်တန်းကျောင်း</option>
                            <option value="other">အခြား</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ကုန်ကျစရိတ် *</label>
                        <input type="text" id="eduCost" required placeholder="ဥပမာ: 150,000 ကျပ်/လ">
                    </div>
                    <div class="form-group">
                        <label>သင်တန်းများ / အစီအစဉ်များ</label>
                        <textarea id="eduCourses" rows="4" placeholder="သင်တန်းအမည်များ၊ အချိန်ကာလ၊ အကျိုးခံစားခွင့်များ"></textarea>
                    </div>
                    <div class="form-group">
                        <label>လိပ်စာ *</label>
                        <input type="text" id="eduAddress" required>
                    </div>
                    <div class="form-group">
                        <label>ပုံ</label>
                        <input type="file" id="eduImage" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label>ဖုန်းနံပါတ် *</label>
                        <input type="tel" id="eduPhone" required>
                    </div>
                    <button type="submit" class="btn-primary">တင်မည်</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Supabase Configuration (Reusing your credentials)
        const SUPABASE_URL = 'https://zrhslpbtzddtgdifzdhj.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpyaHNscGJ0emRkdGdkaWZ6ZGhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjExNjgwMzMsImV4cCI6MjA3Njc0NDAzM30.r7ylCuNq23tpCctb1MibwHAxU-P549lvDKkqxhalq9s';
        
        let supabase;
        
        try {
            supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            console.log('✅ Supabase client initialized successfully');
        } catch (error) {
            console.error('❌ Failed to initialize Supabase:', error);
        }

        let map, geocoder, infoWindow;
        let markers = [];
        let cart = [];
        let currentMainCategory = 'properties'; // Default to properties

        // Sample Products
        const sampleProducts = [
            {
                id: 1,
                name: "iPhone 14 Pro Max",
                price: 2890000,
                category: "electronics",
                image: "https://images.unsplash.com/photo-1678652197831-2d180705cd2c?w=400",
                phone: "09-123-456-789"
            },
            {
                id: 2,
                name: "Nike Air Max",
                price: 180000,
                category: "fashion",
                image: "https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=400",
                phone: "09-123-456-789"
            },
            {
                id: 3,
                name: "Coffee Maker",
                price: 95000,
                category: "home",
                image: "https://images.unsplash.com/photo-1517668808822-9ebb02f2a0e6?w=400",
                phone: "09-123-456-789"
            },
            {
                id: 4,
                name: "⚡ Flash Sale - Wireless Earbuds",
                price: 45000,
                category: "flash-sale",
                image: "https://images.unsplash.com/photo-1590658268037-6bf12165a8df?w=400",
                phone: "09-123-456-789",
                originalPrice: 85000,
                discount: "47% OFF"
            },
            {
                id: 5,
                name: "⚡ Flash Sale - Smart Watch",
                price: 120000,
                category: "flash-sale",
                image: "https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=400",
                phone: "09-123-456-789",
                originalPrice: 200000,
                discount: "40% OFF"
            },
            {
                id: 6,
                name: "⚡ Flash Sale - Bluetooth Speaker",
                price: 35000,
                category: "flash-sale",
                image: "https://images.unsplash.com/photo-1608043152269-423dbba4e7e1?w=400",
                phone: "09-123-456-789",
                originalPrice: 70000,
                discount: "50% OFF"
            }
        ];

        // Initialize
        window.addEventListener('load', function() {
            // Initialize map first since properties is default
            setTimeout(function() {
                initMap();
                loadProperties(); // Load properties first
                loadAirTickets();
                loadCarTickets();
                loadProducts();
                startCountdown(); // Start flash sale countdown
            }, 500);
        });

        // Flash Sale Countdown Timer
        function startCountdown() {
            // Set end time (24 hours from now for demo, you can set a specific date)
            const endTime = new Date().getTime() + (24 * 60 * 60 * 1000);
            
            function updateCountdown() {
                const now = new Date().getTime();
                const distance = endTime - now;
                
                if (distance < 0) {
                    // Timer expired
                    document.getElementById('hours').textContent = '00';
                    document.getElementById('minutes').textContent = '00';
                    document.getElementById('seconds').textContent = '00';
                    return;
                }
                
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                
                document.getElementById('hours').textContent = String(hours).padStart(2, '0');
                document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
                document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');
            }
            
            // Update immediately
            updateCountdown();
            
            // Update every second
            setInterval(updateCountdown, 1000);
        }

        function initMap() {
            if (typeof google === 'undefined' || !google.maps) {
                console.log('Waiting for Google Maps...');
                setTimeout(initMap, 500);
                return;
            }

            console.log('✅ Initializing Google Maps for Dawei...');
            
            map = new google.maps.Map(document.getElementById('map'), {
                center: { lat: 14.0825, lng: 98.1892 }, // Dawei, Myanmar
                zoom: 13,
                mapTypeControl: true,
                streetViewControl: true,
                fullscreenControl: true,
            });

            geocoder = new google.maps.Geocoder();
            infoWindow = new google.maps.InfoWindow();

            console.log('✅ Map initialized successfully!');
        }

        // Switch Main Category
        function switchMainCategory(category) {
            currentMainCategory = category;
            
            document.querySelectorAll('.main-cat-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            document.querySelectorAll('.section').forEach(section => section.classList.remove('active'));
            
            if (category === 'products') {
                document.getElementById('productsSection').classList.add('active');
            } else if (category === 'properties') {
                document.getElementById('propertiesSection').classList.add('active');
                setTimeout(() => {
                    if (map) google.maps.event.trigger(map, 'resize');
                }, 100);
            } else if (category === 'jobs') {
                document.getElementById('jobsSection').classList.add('active');
            } else if (category === 'healthcare') {
                document.getElementById('healthcareSection').classList.add('active');
            } else if (category === 'repair') {
                document.getElementById('repairSection').classList.add('active');
            } else if (category === 'beauty') {
                document.getElementById('beautySection').classList.add('active');
            } else if (category === 'food') {
                document.getElementById('foodSection').classList.add('active');
            } else if (category === 'education') {
                document.getElementById('educationSection').classList.add('active');
            } else if (category === 'air-tickets') {
                document.getElementById('airTicketsSection').classList.add('active');
            } else if (category === 'car-tickets') {
                document.getElementById('carTicketsSection').classList.add('active');
            }
        }

        // Load Products
        function loadProducts() {
            const grid = document.getElementById('productsGrid');
            grid.innerHTML = sampleProducts.map(product => `
                <div class="product-card">
                    ${product.category === 'flash-sale' ? '<div style="position: absolute; top: 10px; right: 10px; background: #f5576c; color: white; padding: 5px 10px; border-radius: 4px; font-weight: bold; font-size: 12px; z-index: 1;">' + product.discount + '</div>' : ''}
                    <img src="${product.image}" alt="${product.name}" class="product-image">
                    <div class="product-info">
                        <div class="product-name">${product.name}</div>
                        ${product.originalPrice ? '<div style="text-decoration: line-through; color: #999; font-size: 14px;">' + product.originalPrice.toLocaleString() + ' ကျပ်</div>' : ''}
                        <div class="product-price" ${product.category === 'flash-sale' ? 'style="color: #f5576c; font-size: 20px;"' : ''}>${product.price.toLocaleString()} ကျပ်</div>
                        <button class="add-to-cart-btn" onclick="addToCart(${product.id}, 'product')">ဈေးခြင်းထည့်မည်</button>
                    </div>
                </div>
            `).join('');
            
            // Also load flash sale products in dedicated section
            loadFlashSaleProducts();
        }

        // Load Flash Sale Products in dedicated grid
        function loadFlashSaleProducts() {
            const flashSaleGrid = document.getElementById('flashSaleProducts');
            const flashSaleItems = sampleProducts.filter(p => p.category === 'flash-sale');
            
            if (flashSaleItems.length > 0) {
                flashSaleGrid.innerHTML = flashSaleItems.map(product => `
                    <div class="flash-sale-product-card">
                        <div class="flash-sale-discount">${product.discount}</div>
                        <img src="${product.image}" alt="${product.name}" class="product-image">
                        <div class="product-info">
                            <div class="product-name">${product.name}</div>
                            <div style="text-decoration: line-through; color: #999; font-size: 13px; margin-bottom: 4px;">${product.originalPrice.toLocaleString()} ကျပ်</div>
                            <div class="product-price" style="color: #f5576c; font-size: 20px; margin-bottom: 12px;">${product.price.toLocaleString()} ကျပ်</div>
                            <button class="add-to-cart-btn" onclick="addToCart(${product.id}, 'product')">ဈေးခြင်းထည့်မည်</button>
                        </div>
                    </div>
                `).join('');
            }
        }

        // Load Properties from Supabase
        async function loadProperties() {
            console.log('📍 Loading properties from Supabase...');
            
            const { data, error } = await supabase
                .from('properties')
                .select('*')
                .order('created_at', { ascending: false });

            if (error) {
                console.error('❌ Error loading properties:', error);
                document.getElementById('propertiesGrid').innerHTML = `
                    <p style="grid-column: 1/-1; text-align: center; padding: 40px; color: #999;">
                        Error loading properties. Please check Supabase connection.
                    </p>
                `;
                return;
            }

            if (!data || data.length === 0) {
                console.log('ℹ️ No properties found');
                document.getElementById('propertiesGrid').innerHTML = `
                    <p style="grid-column: 1/-1; text-align: center; padding: 40px; color: #999;">
                        📭 အိမ်ခြံမြေမရှိသေးပါ။ ပထမဆုံးတင်သူဖြစ်ပါ!
                    </p>
                `;
                return;
            }

            console.log(`✅ Loaded ${data.length} properties`);

            // Display properties in grid
            const grid = document.getElementById('propertiesGrid');
            grid.innerHTML = data.map(property => {
                const timeAgo = getTimeAgo(property.created_at);
                const propertyType = property.property_type || 'Condo';
                const isPromoted = property.is_promoted || false;
                const isVerified = property.is_verified !== false; // Default to verified
                const sqft = property.sqft || 'N/A';
                
                return `
                <div class="product-card" data-property-id="${property.id}">
                    ${isPromoted ? '<div class="promoted-badge">Promoted</div>' : ''}
                    <div class="compare-checkbox">
                        <input type="checkbox" id="compare-${property.id}" onchange="toggleCompare(${property.id}, '${property.title}', '${property.price}')">
                        <label for="compare-${property.id}">Compare</label>
                    </div>
                    <button class="favorite-btn" onclick="toggleFavorite(event, ${property.id})">♡</button>
                    <img src="${property.image_url}" alt="${property.title}" class="product-image" onerror="this.src='https://via.placeholder.com/400x300?text=No+Image'">
                    <div class="product-info">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px;">
                            <div class="product-price">${property.price.toLocaleString()} သိန်း</div>
                            ${isVerified ? '<span class="verified-badge">✓ Verified</span>' : ''}
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span class="property-type">${propertyType}</span>
                            <span class="property-time">• ${timeAgo}</span>
                        </div>
                        <div class="property-details">
                            <div class="property-detail-item">
                                <span>${property.land_type || 'မြေကွက်'}</span>
                            </div>
                            ${property.dimensions ? `<div class="property-detail-item"><span>• ပေ ${property.dimensions}</span></div>` : ''}
                            ${!property.land_type && property.beds ? `<div class="property-detail-item"><span>${property.beds} - ${property.beds} BED</span></div>` : ''}
                            ${!property.land_type && property.baths ? `<div class="property-detail-item"><span>• ${property.baths} BATH</span></div>` : ''}
                            <div class="property-detail-item">
                                <span>• ${sqft} FT²</span>
                            </div>
                        </div>
                        <div class="product-location">📍 ${property.address}</div>
                        <button class="details-btn" onclick="showPropertyDetails(${property.id})">Details</button>
                    </div>
                </div>
            `;
            }).join('');

            // Clear existing markers
            markers.forEach(m => m.setMap(null));
            markers = [];

            // Add markers to map
            data.forEach(property => {
                const marker = new google.maps.Marker({
                    position: { lat: property.lat, lng: property.lng },
                    map: map,
                    title: property.title,
                    label: {
                        text: property.price.toString(),
                        color: 'white',
                        fontSize: '12px',
                        fontWeight: 'bold'
                    },
                    icon: {
                        path: google.maps.SymbolPath.CIRCLE,
                        scale: 20,
                        fillColor: '#667eea',
                        fillOpacity: 1,
                        strokeColor: 'white',
                        strokeWeight: 2,
                    }
                });

                // Add click listener to show info
                marker.addListener('click', function() {
                    const content = `
                        <div style="padding: 10px; max-width: 250px;">
                            <img src="${property.image_url}" style="width: 100%; height: 150px; object-fit: cover; border-radius: 8px; margin-bottom: 8px;" />
                            <h3 style="margin: 0 0 8px 0; font-size: 16px;">${property.title}</h3>
                            <p style="margin: 0 0 8px 0; font-size: 20px; font-weight: 700; color: #667eea;">${property.price.toLocaleString()} သိန်း</p>
                            <p style="margin: 0 0 4px 0; font-size: 14px; color: #6b7280;">📍 ${property.address}</p>
                            <div style="display: flex; gap: 12px; font-size: 14px; color: #6b7280; margin-bottom: 8px;">
                                <span>🛏️ ${property.beds}</span>
                                <span>🚿 ${property.baths}</span>
                                <span>📏 ${property.sqft || 'N/A'} sqft</span>
                            </div>
                            <p style="margin-top: 8px; font-size: 14px;"><strong>📞 ${property.contact_phone}</strong></p>
                        </div>
                    `;
                    infoWindow.setContent(content);
                    infoWindow.open(map, marker);
                });

                markers.push(marker);
            });

            // Fit map bounds to show all markers
            if (markers.length > 0) {
                const bounds = new google.maps.LatLngBounds();
                markers.forEach(marker => bounds.extend(marker.getPosition()));
                map.fitBounds(bounds);
                
                // Don't zoom too close if only one marker
                google.maps.event.addListenerOnce(map, 'bounds_changed', function() {
                    if (this.getZoom() > 15) {
                        this.setZoom(15);
                    }
                });
            }
        }

        // Helper function to calculate time ago
        function getTimeAgo(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffInMs = now - date;
            const diffInHours = Math.floor(diffInMs / (1000 * 60 * 60));
            const diffInDays = Math.floor(diffInHours / 24);
            
            if (diffInDays === 0) {
                return 'today';
            } else if (diffInDays === 1) {
                return '1 day ago';
            } else if (diffInDays < 7) {
                return `${diffInDays} days ago`;
            } else if (diffInDays < 30) {
                const weeks = Math.floor(diffInDays / 7);
                return `${weeks} week${weeks > 1 ? 's' : ''} ago`;
            } else {
                const months = Math.floor(diffInDays / 30);
                return `${months} month${months > 1 ? 's' : ''} ago`;
            }
        }

        // Toggle favorite (placeholder - would need backend to persist)
        function toggleFavorite(event, propertyId) {
            event.stopPropagation();
            const btn = event.target;
            if (btn.textContent === '♡') {
                btn.textContent = '♥';
                btn.style.color = '#ff6b35';
                showNotification('Added to favorites');
            } else {
                btn.textContent = '♡';
                btn.style.color = '#666';
                showNotification('Removed from favorites');
            }
        }

        // Show property details (placeholder - would open a modal with full details)
        function showPropertyDetails(propertyId) {
            showNotification('Opening property details...');
            // In a real app, this would open a modal or navigate to a detail page
        }

        // Compare Properties Feature
        let compareList = [];

        function toggleCompare(propertyId, title, price) {
            const checkbox = document.getElementById(`compare-${propertyId}`);
            const compareBar = document.getElementById('compareBar');
            const compareCount = document.getElementById('compareCount');

            if (checkbox.checked) {
                if (compareList.length >= 3) {
                    checkbox.checked = false;
                    showNotification('You can only compare up to 3 properties');
                    return;
                }
                compareList.push({ id: propertyId, title, price });
            } else {
                compareList = compareList.filter(p => p.id !== propertyId);
            }

            // Update compare bar
            if (compareList.length > 0) {
                compareBar.classList.add('active');
                compareCount.textContent = `${compareList.length} ${compareList.length === 1 ? 'property' : 'properties'} selected`;
            } else {
                compareBar.classList.remove('active');
            }
        }

        function compareProperties() {
            if (compareList.length < 2) {
                showNotification('Please select at least 2 properties to compare');
                return;
            }
            showNotification(`Comparing ${compareList.length} properties...`);
            // In a real app, this would open a comparison view
        }

        function clearCompare() {
            compareList = [];
            document.querySelectorAll('.compare-checkbox input[type="checkbox"]').forEach(cb => cb.checked = false);
            document.getElementById('compareBar').classList.remove('active');
            showNotification('Comparison cleared');
        }

        // Advanced Filters
        function applyFilters() {
            const type = document.getElementById('filterType').value;
            const propertyType = document.getElementById('filterPropertyType').value;
            const township = document.getElementById('filterTownship').value;
            const priceRange = document.getElementById('filterPrice').value;

            showNotification('Applying filters...');
            // In a real app, this would filter the properties based on selections
            loadProperties(); // Reload with filters
        }

        // Quick Search
        function quickSearch(searchType) {
            showNotification(`Searching for ${searchType}...`);
            // In a real app, this would apply predefined filters
            loadProperties();
        }

        // Toggle property form fields based on type
        function togglePropertyFields() {
            const propType = document.getElementById('propType').value;
            const dimensionsGroup = document.getElementById('dimensionsGroup');
            const bedsAndBathsGroup = document.getElementById('bedsAndBathsGroup');
            
            if (propType === 'Land') {
                dimensionsGroup.style.display = 'block';
                bedsAndBathsGroup.style.display = 'none';
                document.getElementById('propDimensions').required = true;
                document.getElementById('propBeds').required = false;
                document.getElementById('propBaths').required = false;
            } else {
                dimensionsGroup.style.display = 'none';
                bedsAndBathsGroup.style.display = 'flex';
                document.getElementById('propDimensions').required = false;
                document.getElementById('propBeds').required = false;
                document.getElementById('propBaths').required = false;
            }
        }

        // Load Air Tickets from Supabase
        async function loadAirTickets() {
            console.log('✈️ Loading air tickets from Supabase...');
            
            const { data, error } = await supabase
                .from('air_tickets')
                .select('*')
                .order('created_at', { ascending: false });

            if (error) {
                console.error('❌ Error loading air tickets:', error);
                return;
            }

            const grid = document.getElementById('airTicketsGrid');
            
            if (!data || data.length === 0) {
                grid.innerHTML = `
                    <p style="grid-column: 1/-1; text-align: center; padding: 40px; color: #999;">
                        📭 လေယာဉ်လက်မှတ်မရှိသေးပါ။ ပထမဆုံးတင်သူဖြစ်ပါ!
                    </p>
                `;
                return;
            }

            console.log(`✅ Loaded ${data.length} air tickets`);

            grid.innerHTML = data.map(ticket => `
                <div class="product-card">
                    <div class="product-info">
                        <div class="product-name">✈️ ${ticket.from_city} → ${ticket.to_city}</div>
                        <div class="product-price">${ticket.price.toLocaleString()} ကျပ်</div>
                        <div class="product-location">📅 ${new Date(ticket.depart_date).toLocaleDateString('en-GB')}</div>
                        ${ticket.airline ? `<div class="product-location">🛫 ${ticket.airline}</div>` : ''}
                        <div class="product-location">📞 ${ticket.contact_phone}</div>
                    </div>
                </div>
            `).join('');
        }

        // Load Car Tickets from Supabase
        async function loadCarTickets() {
            console.log('🚗 Loading car tickets from Supabase...');
            
            const { data, error } = await supabase
                .from('car_tickets')
                .select('*')
                .order('created_at', { ascending: false });

            if (error) {
                console.error('❌ Error loading car tickets:', error);
                return;
            }

            const grid = document.getElementById('carTicketsGrid');
            
            if (!data || data.length === 0) {
                grid.innerHTML = `
                    <p style="grid-column: 1/-1; text-align: center; padding: 40px; color: #999;">
                        📭 ကားလက်မှတ်မရှိသေးပါ။ ပထမဆုံးတင်သူဖြစ်ပါ!
                    </p>
                `;
                return;
            }

            console.log(`✅ Loaded ${data.length} car tickets`);

            grid.innerHTML = data.map(car => `
                <div class="product-card">
                    <div class="product-info">
                        <div class="product-name">🚗 ${car.from_city} → ${car.to_city}</div>
                        <div class="product-price">${car.price.toLocaleString()} ကျပ်/လူ</div>
                        <div class="product-location">📅 ${new Date(car.depart_date).toLocaleDateString('en-GB')} ${car.depart_time}</div>
                        <div class="product-location">💺 ${car.seats} လက်ကျန်နေရာ</div>
                        <div class="product-location">🚙 ${car.car_type}</div>
                        <div class="product-location">📞 ${car.contact_phone}</div>
                    </div>
                </div>
            `).join('');
        }

        // Filter Products
        function filterProducts(category) {
            const filtered = sampleProducts.filter(p => p.category === category);
            const grid = document.getElementById('productsGrid');
            grid.innerHTML = filtered.map(product => `
                <div class="product-card">
                    ${product.category === 'flash-sale' ? '<div style="position: absolute; top: 10px; right: 10px; background: #f5576c; color: white; padding: 5px 10px; border-radius: 4px; font-weight: bold; font-size: 12px; z-index: 1;">' + product.discount + '</div>' : ''}
                    <img src="${product.image}" alt="${product.name}" class="product-image">
                    <div class="product-info">
                        <div class="product-name">${product.name}</div>
                        ${product.originalPrice ? '<div style="text-decoration: line-through; color: #999; font-size: 14px;">' + product.originalPrice.toLocaleString() + ' ကျပ်</div>' : ''}
                        <div class="product-price" ${product.category === 'flash-sale' ? 'style="color: #f5576c; font-size: 20px;"' : ''}>${product.price.toLocaleString()} ကျပ်</div>
                        <button class="add-to-cart-btn" onclick="addToCart(${product.id}, 'product')">ဈေးခြင်းထည့်မည်</button>
                    </div>
                </div>
            `).join('');
        }

        // Cart Functions
        function addToCart(id, type) {
            const item = sampleProducts.find(p => p.id === id);
            if (item) {
                const existing = cart.find(c => c.id === id);
                if (existing) {
                    existing.quantity++;
                } else {
                    cart.push({ ...item, quantity: 1 });
                }
                updateCart();
                showNotification('ဈေးခြင်းထည့်ပြီးပါပြီ');
            }
        }

        function updateCart() {
            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartCount').textContent = count;

            const cartItems = document.getElementById('cartItems');
            if (cart.length === 0) {
                cartItems.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #999;">
                        <div style="font-size: 64px;">🛒</div>
                        <p>ဈေးခြင်းမှာ ပစ္စည်းမရှိပါ</p>
                    </div>
                `;
            } else {
                cartItems.innerHTML = cart.map(item => `
                    <div style="padding: 15px; border-bottom: 1px solid #e0e0e0;">
                        <div style="font-weight: 600; margin-bottom: 5px;">${item.name}</div>
                        <div style="color: #ff6b35; font-weight: bold;">${item.price.toLocaleString()} ကျပ်</div>
                        <div style="margin-top: 10px;">အရေအတွက်: ${item.quantity}</div>
                    </div>
                `).join('');
            }
        }

        function toggleCart() {
            document.getElementById('cartModal').classList.toggle('active');
            document.getElementById('cartOverlay').classList.toggle('active');
        }

        // Post Modal Functions
        function openPostModal() {
            document.getElementById('postModal').classList.add('active');
            document.getElementById('postTypeSelection').style.display = 'block';
            hideAllForms();
        }

        function closePostModal() {
            document.getElementById('postModal').classList.remove('active');
            hideAllForms();
            document.getElementById('postTypeSelection').style.display = 'block';
        }

        function hideAllForms() {
            document.getElementById('productForm').style.display = 'none';
            document.getElementById('propertyForm').style.display = 'none';
            document.getElementById('airTicketForm').style.display = 'none';
            document.getElementById('carTicketForm').style.display = 'none';
            document.getElementById('educationForm').style.display = 'none';
        }

        function selectPostType(type) {
            document.getElementById('postTypeSelection').style.display = 'none';
            hideAllForms();
            
            if (type === 'product') {
                document.getElementById('productForm').style.display = 'block';
                document.getElementById('postModalTitle').textContent = '🛒 ကုန်ပစ္စည်းတင်ရန်';
            } else if (type === 'property') {
                document.getElementById('propertyForm').style.display = 'block';
                document.getElementById('postModalTitle').textContent = '🏠 အိမ်ခြံမြေတင်ရန်';
            } else if (type === 'education') {
                document.getElementById('educationForm').style.display = 'block';
                document.getElementById('postModalTitle').textContent = '📚 ပညာရေးဌာနတင်ရန်';
            } else if (type === 'air-ticket') {
                document.getElementById('airTicketForm').style.display = 'block';
                document.getElementById('postModalTitle').textContent = '✈️ လေယာဉ်လက်မှတ်တင်ရန်';
            } else if (type === 'car-ticket') {
                document.getElementById('carTicketForm').style.display = 'block';
                document.getElementById('postModalTitle').textContent = '🚗 ကားလက်မှတ်တင်ရန်';
            }
        }

        // Submit Forms
        async function submitProduct(event) {
            event.preventDefault();
            const imageFile = document.getElementById('prodImage').files[0];
            
            if (imageFile) {
                const fileName = `${Date.now()}-${imageFile.name}`;
                const { data: uploadData, error: uploadError } = await supabase.storage
                    .from('property-images')
                    .upload(`products/${fileName}`, imageFile);

                if (!uploadError) {
                    const { data: { publicUrl } } = supabase.storage
                        .from('property-images')
                        .getPublicUrl(`products/${fileName}`);

                    // Add to sample products
                    const newProduct = {
                        id: Date.now(),
                        name: document.getElementById('prodName').value,
                        price: parseInt(document.getElementById('prodPrice').value),
                        category: document.getElementById('prodCategory').value,
                        image: publicUrl,
                        phone: document.getElementById('prodPhone').value
                    };
                    
                    sampleProducts.push(newProduct);
                    loadProducts();
                    closePostModal();
                    showNotification('တင်ပြီးပါပြီ!');
                }
            }
        }

        async function submitProperty(event) {
            event.preventDefault();
            const imageFile = document.getElementById('propImage').files[0];
            
            if (imageFile) {
                const fileName = `${Date.now()}-${imageFile.name}`;
                const { data: uploadData, error: uploadError } = await supabase.storage
                    .from('property-images')
                    .upload(`properties/${fileName}`, imageFile);

                if (!uploadError) {
                    const { data: { publicUrl } } = supabase.storage
                        .from('property-images')
                        .getPublicUrl(`properties/${fileName}`);

                    const address = document.getElementById('propAddress').value;
                    
                    geocoder.geocode({ address: address }, async (results, status) => {
                        if (status === 'OK') {
                            const location = results[0].geometry.location;
                            
                            const { error } = await supabase
                                .from('properties')
                                .insert([{
                                    title: document.getElementById('propTitle').value,
                                    property_type: document.getElementById('propType').value,
                                    price: parseInt(document.getElementById('propPrice').value),
                                    address: address,
                                    beds: parseInt(document.getElementById('propBeds').value) || 0,
                                    baths: parseInt(document.getElementById('propBaths').value) || 0,
                                    sqft: parseInt(document.getElementById('propSqft').value) || 0,
                                    dimensions: document.getElementById('propDimensions').value || null,
                                    land_type: document.getElementById('propType').value === 'Land' ? 'မြေကွက်' : null,
                                    description: '',
                                    contact_name: '',
                                    contact_phone: document.getElementById('propPhone').value,
                                    image_url: publicUrl,
                                    lat: location.lat(),
                                    lng: location.lng(),
                                    is_promoted: document.getElementById('propPromoted').checked,
                                    is_verified: true
                                }]);

                            if (!error) {
                                loadProperties();
                                closePostModal();
                                showNotification('တင်ပြီးပါပြီ!');
                            }
                        }
                    });
                }
            }
        }

        async function submitAirTicket(event) {
            event.preventDefault();
            
            const { error } = await supabase
                .from('air_tickets')
                .insert([{
                    from_city: document.getElementById('airFrom').value,
                    to_city: document.getElementById('airTo').value,
                    depart_date: document.getElementById('airDate').value,
                    return_date: null,
                    airline: null,
                    price: parseInt(document.getElementById('airPrice').value),
                    contact_phone: document.getElementById('airPhone').value
                }]);

            if (!error) {
                loadAirTickets();
                closePostModal();
                showNotification('တင်ပြီးပါပြီ!');
            }
        }

        async function submitCarTicket(event) {
            event.preventDefault();
            
            const { error } = await supabase
                .from('car_tickets')
                .insert([{
                    from_city: document.getElementById('carFrom').value,
                    to_city: document.getElementById('carTo').value,
                    depart_date: document.getElementById('carDate').value,
                    depart_time: document.getElementById('carTime').value,
                    car_type: 'sedan',
                    seats: parseInt(document.getElementById('carSeats').value),
                    price: parseInt(document.getElementById('carPrice').value),
                    contact_phone: document.getElementById('carPhone').value
                }]);

            if (!error) {
                loadCarTickets();
                closePostModal();
                showNotification('တင်ပြီးပါပြီ!');
            }
        }

        async function submitEducation(event) {
            event.preventDefault();
            showNotification('Education center submitted! (Database integration pending)');
            closePostModal();
            
            // In a real implementation, this would save to a Supabase table
            // For now, just show success notification
            console.log({
                name: document.getElementById('eduName').value,
                type: document.getElementById('eduType').value,
                cost: document.getElementById('eduCost').value,
                courses: document.getElementById('eduCourses').value,
                address: document.getElementById('eduAddress').value,
                phone: document.getElementById('eduPhone').value
            });
        }

        // Search
        function searchItems() {
            const term = document.getElementById('searchInput').value.toLowerCase();
            // Implement search logic here
        }

        // Notification
        function showNotification(message) {
            const notif = document.createElement('div');
            notif.textContent = message;
            notif.style.cssText = `
                position: fixed;
                top: 80px;
                right: 20px;
                background: #4caf50;
                color: white;
                padding: 15px 25px;
                border-radius: 8px;
                box-shadow: 0 4px 8px rgba(0,0,0,0.2);
                z-index: 10000;
            `;
            document.body.appendChild(notif);
            setTimeout(() => notif.remove(), 2000);
        }

        // PWA Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => {
                        console.log('PWA: Service Worker registered successfully:', registration.scope);
                    })
                    .catch(error => {
                        console.log('PWA: Service Worker registration failed:', error);
                    });
            });
        }

        // PWA Install Prompt
        let deferredPrompt;
        const installButton = document.createElement('button');
        installButton.id = 'installPWA';
        installButton.innerHTML = '📱 Install App';
        installButton.style.cssText = `
            display: none;
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            z-index: 9999;
            animation: pulse 2s infinite;
        `;
        document.body.appendChild(installButton);

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installButton.style.display = 'block';
            
            // Also show banner buttons
            const mainInstallBtnTop = document.getElementById('mainInstallBtnTop');
            if (mainInstallBtnTop) {
                mainInstallBtnTop.style.display = 'flex';
            }
        });

        // Function to trigger install from banner buttons
        async function triggerInstallFromBanner() {
            if (!deferredPrompt) {
                showNotification('Install prompt not available. Please try again or use browser menu → Install App');
                return;
            }
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            console.log(`User response to install prompt: ${outcome}`);
            if (outcome === 'accepted') {
                showNotification('Installing app... 📲');
            }
            deferredPrompt = null;
            installButton.style.display = 'none';
            
            // Hide banner buttons
            const mainInstallBtnTop = document.getElementById('mainInstallBtnTop');
            if (mainInstallBtnTop) {
                mainInstallBtnTop.parentElement.style.display = 'none';
            }
        }

        // Function to show iOS installation instructions
        function showIOSInstructions() {
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
            const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
            
            if (isIOS && isSafari) {
                showNotification(`
                    📱 To install on iPhone:
                    1. Tap the Share button (⬆️)
                    2. Scroll down and tap "Add to Home Screen"
                    3. Tap "Add"
                `);
            } else if (isIOS) {
                showNotification('Please open this site in Safari browser to install on iPhone');
            } else {
                // Not iOS, trigger regular install
                triggerInstallFromBanner();
            }
        }

        installButton.addEventListener('click', async () => {
            if (!deferredPrompt) return;
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            console.log(`User response to install prompt: ${outcome}`);
            deferredPrompt = null;
            installButton.style.display = 'none';
        });

        window.addEventListener('appinstalled', () => {
            console.log('PWA was installed');
            showNotification('App installed successfully! 🎉');
            installButton.style.display = 'none';
            
            // Hide banner buttons
            const mainInstallBtnTop = document.getElementById('mainInstallBtnTop');
            if (mainInstallBtnTop && mainInstallBtnTop.parentElement) {
                mainInstallBtnTop.parentElement.style.display = 'none';
            }
        });

        // Check if app is already installed
        if (window.matchMedia('(display-mode: standalone)').matches) {
            console.log('Running as installed PWA');
            installButton.style.display = 'none';
            
            // Hide banner completely if already installed
            setTimeout(() => {
                const mainInstallBtnTop = document.getElementById('mainInstallBtnTop');
                if (mainInstallBtnTop && mainInstallBtnTop.parentElement && mainInstallBtnTop.parentElement.parentElement) {
                    mainInstallBtnTop.parentElement.parentElement.style.display = 'none';
                }
            }, 100);
        }

        // Add pulse animation for install button
        const style = document.createElement('style');
        style.textContent = `
            @keyframes pulse {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.05); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
